<!DOCTYPE html><html><head>
<meta name='viewport' content='width=device-width, initial-scale=1.0' />
<meta name="referrer" content="no-referrer" />
<script src='https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.7/shaka-player.ui.js' crossorigin='anonymous'></script>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.7/controls.css' crossorigin='anonymous' />
</head><body><script>!function(a,b,c,d,e,f){a.ddjskey=e;a.ddoptions=f||null;var m=b.createElement(c),n=b.getElementsByTagName(c)[0];m.async=1,m.src=d,n.parentNode.insertBefore(m,n)}(window,document,"script","https://js.datadome.co/tags.js","99B1C08278137CE22ADB60CE8DE020", {"ajaxListenerPath": true});</script>
<body bgcolor='black' style='margin:0' oncontextmenu='return false' onkeydown='return false' onmousedown='return false'><script>!function(a,b,c,d,e,f){a.ddjskey=e;a.ddoptions=f||null;var m=b.createElement(c),n=b.getElementsByTagName(c)[0];m.async=1,m.src=d,n.parentNode.insertBefore(m,n)}(window,document,"script","https://js.datadome.co/tags.js","99B1C08278137CE22ADB60CE8DE020", {"ajaxListenerPath": true});</script>
<center> 
<div data-shaka-player-container id="data-shaka-player-container" style='width: 100%; height: 100%'><video autoplay data-shaka-player id='video' style='width:100%;height:100%;'></video></div>
<script> 
async function init() { 
var video = document.getElementById('video');  
//var ui = video['ui']; 
//var controls = ui.getControls(); 
var player;
var ui;

setupPlayer();	
function setupPlayer(){
	player = new shaka.Player(video);
	ui = video['ui']; 
	player = ui.getControls().getPlayer();
	player.configure({
	  drm: {
		clearKeys: {
		  // 'key-id-in-hex': 'key-in-hex',
			'01eb1168208940f8b270b4e0994570e7': 'e75165d38b909567c03353ae4b27b6f8'
		}
	  }
	});
	   player.setTextTrackVisibility(true);
	//player.configure({drm:{servers:{'com.widevine.alpha':'https://license.dstv.com/widevine/getLicense?CrmId=afl&AccountId=afl&ContentId=SH2&SessionId=D3C00F885C24B9C6&Ticket=C839A8D71AB94299'}}}); 
	window.player = player; 
	//window.ui = ui; 
	player.addEventListener('error', onPlayerErrorEvent); 
	player.addEventListener('buffering', function(event) {
		if (event.buffering) {
			// Buffering started
			console.log('Buffering started...');
			bufferingStartTime = Date.now();

			// Set a timeout for 3 seconds
			bufferingTimeout = setTimeout(function() {
				console.log('Buffering has lasted more than 3 seconds.');
				// You can add additional logic here, like showing a message to the user
				reloadPlayer();
			}, 3000);

		} else {
			// Buffering ended
			console.log('Buffering ended.');

			if (bufferingTimeout) {
				clearTimeout(bufferingTimeout);
			}

			// Calculate the total buffering time
			if (bufferingStartTime !== null) {
				const bufferingDuration = Date.now() - bufferingStartTime;
				console.log(`Buffering lasted ${bufferingDuration} ms.`);
			}

			// Reset the start time
			bufferingStartTime = null;
		}
	});

	//controls.addEventListener('error', onUIErrorEvent); 
	try{player.load('https://d1yws6emo43ny.cloudfront.net/CH1/masterCH1.mpd'); 
	console.log('The video has now been loaded!');} catch (error) {onPlayerError(error);}
}
function reloadPlayer(){
	if (player) {
		player.destroy().then(() => {
			console.log('Player destroyed. Reloading...');	
			//player = new shaka.Player(video);
			//player = controls.getPlayer(); 
			setupPlayer(); // Function to reinitialize the player
		});
	}
}
}

function onPlayerErrorEvent(errorEvent) {onPlayerError(event.detail);} 
function onPlayerError(error) {console.error('Error code', error.code, 'object', error);} 
function onUIErrorEvent(errorEvent) {onPlayerError(event.detail);} 
function initFailed(errorEvent) {console.error('Unable to load the UI library!');} 
document.addEventListener('shaka-ui-loaded', init); 
document.addEventListener('shaka-ui-load-failed', initFailed); 
</script>
</html>
